<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Firefox os cb2g issues timeline</title>
<!--   <meta http-equiv="Access-Control-Allow-Origin" content="*"> 
 -->  <meta name="description" content="mobile first, app, web app, responsive, admin dashboard, flat, flat ui">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"> 
  <link rel="stylesheet" href="css/bootstrap.css">
  <link rel="stylesheet" href="css/font-awesome.min.css">
  <link rel="stylesheet" href="css/plugin.css">
  <link rel="stylesheet" href="css/style.css">
  <style>
    .timeline:before{
	  width: 1px;
	  margin-left: 0px;
	}
  </style>
</head>
<body>
  <!-- header -->
  <header id="header" class="navbar">    
    <ul class="nav navbar-nav navbar-avatar pull-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">            
          <span class="hidden-sm-only">Mika Sokeil</span>
          <span class="thumb-small avatar inline"><img src="images/avatar.jpg" alt="Mika Sokeil" class="img-circle"></span>
          <b class="caret hidden-sm-only"></b>
        </a>
        <ul class="dropdown-menu">
          <li><a href="#">Settings</a></li>
          <li><a href="#">Profile</a></li>
          <li><a href="#"><span class="badge bg-danger pull-right">3</span>Notifications</a></li>
          <li class="divider"></li>
          <li><a href="docs.html">Help</a></li>
          <li><a href="signin.html">Logout</a></li>
        </ul>
      </li>
    </ul>
    <a class="navbar-brand" href="#">first</a>
    <button type="button" class="btn btn-link pull-left nav-toggle hidden-lg" data-toggle="class:show" data-target="#nav">
      <i class="icon-reorder icon-xlarge text-default"></i>
    </button>
    <ul class="nav navbar-nav hidden-sm">
      <li>
        <div class="m-t m-b-small" id="panel-notifications">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="icon-comment-alt icon-xlarge text-default"></i><b class="badge badge-notes bg-danger count-n">2</b></a>
          <section class="dropdown-menu m-l-small m-t-mini">
            <section class="panel panel-large arrow arrow-top">
              <header class="panel-heading bg-white"><span class="h5"><strong>You have <span class="count-n">2</span> notifications</strong></span></header>
              <div class="list-group list-group-flush m-t-n">
                <a href="#" class="media list-group-item">
                  <span class="pull-left thumb-small"><img src="images/avatar.jpg" alt="John said" class="img-circle"></span>
                  <span class="media-body block m-b-none">
                    Moved to Bootstrap 3.0<br>
                    <small class="text-muted">23 June 13</small>
                  </span>
                </a>
                <a href="#" class="media list-group-item">
                  <span class="media-body block m-b-none">
                    first v.1 (Bootstrap 2.3 based) released<br>
                    <small class="text-muted">19 June 13</small>
                  </span>
                </a>
              </div>
              <footer class="panel-footer text-small">
                <a href="#" class="pull-right"><i class="icon-cog"></i></a>
                <a href="#">See all the notifications</a>
              </footer>
            </section>
          </section>
        </div>
      </li>
      <li><div class="m-t-small"><a class="btn btn-small btn-info" data-toggle="modal" href="#modal"><i class="icon-plus"></i> POST</a></div></li>
      <li class="dropdown shift" data-toggle="shift:appendTo" data-target=".nav-primary .nav">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="icon-cog icon-xlarge visible-sm visible-sm-inline"></i>Settings <b class="caret hidden-sm-only"></b></a>
        <ul class="dropdown-menu">
          <li>
            <a href="#" data-toggle="class:navbar-fixed" data-target='body'>Navbar 
              <span class="text-active">auto</span>
              <span class="text">fixed</span>
            </a>
          </li>
          <li class="visible-lg">
            <a href="#" data-toggle="class:nav-vertical" data-target="#nav">Nav 
              <span class="text-active">vertical</span>
              <span class="text">horizontal</span>
            </a>
          </li>
          <li class="divider hidden-sm"></li>
          <li class="dropdown-header">Colors</li>
          <li>
            <a href="#" data-toggle="class:bg bg-black" data-target='.navbar'>Navbar 
              <span class="text-active">white</span>
              <span class="text">inverse</span>
            </a>
          </li>
          <li>
            <a href="#" data-toggle="class:bg-light" data-target='#nav'>Nav 
              <span class="text-active">inverse</span>
              <span class="text">light</span>
            </a>
          </li>
        </ul>
      </li>
    </ul>
    <form class="navbar-form pull-left shift" action="" data-toggle="shift:appendTo" data-target=".nav-primary">
      <i class="icon-search text-muted"></i>
      <input type="text" class="input-small form-control" placeholder="Search">
    </form>
  </header>
  <!-- / header -->
  <!-- nav -->
  <nav id="nav" class="nav-primary visible-lg nav-vertical">
    <ul class="nav" data-spy="affix" data-offset-top="50">
      <li><a href="index.html"><i class="icon-dashboard icon-xlarge"></i><span>Dashboard</span></a></li>
      <li class="active"><a href="timeline.html"><i class="icon-time icon-xlarge"></i> <span>Timeline</span></a></li>
      <li class="dropdown-submenu">
        <a href="#"><i class="icon-th icon-xlarge"></i><span>Elements</span></a>
        <ul class="dropdown-menu">
          <li><a href="buttons.html">Buttons</a></li>
          <li><a href="icons.html"><b class="badge pull-right">302</b>Icons</a></li>            
          <li><a href="grid.html">Grid</a></li>
          <li><a href="widgets.html"><b class="badge bg-primary pull-right">8</b>Widgets</a></li>
          <li><a href="components.html"><b class="badge pull-right">18</b>Components</a></li>
        </ul>
      </li>
      <li class="dropdown-submenu">
        <a href="#"><i class="icon-list icon-xlarge"></i><span>Lists</span></a>
        <ul class="dropdown-menu">
          <li><a href="list.html">List groups</a></li>
          <li><a href="table.html">Table</a></li>
        </ul>
      </li>
      <li><a href="form.html"><i class="icon-edit icon-xlarge"></i><span>Form</span></a></li>
      <li><a href="chart.html"><i class="icon-signal icon-xlarge"></i><span>Chart</span></a></li>
      <li class="dropdown-submenu">
        <a href="#"><i class="icon-link icon-xlarge"></i><span>Others</span></a>
        <ul class="dropdown-menu">
          <li><a href="mail.html">Mail</a></li>
          <li><a href="calendar.html">Fullcalendar</a></li>
          <li><a href="timeline.html">Timeline</a></li>
          <li><a href="profile.html">Profile</a></li>
          <li><a href="signin.html">Signin page</a></li>
          <li><a href="signup.html">Signup page</a></li>
          <li><a href="404.html">404 page</a></li>
        </ul>
      </li>
    </ul>
  </nav>
  <!-- / nav -->
  <section id="content" class="content-sidebar">    
    <!-- .main -->
    <section class="main">
      <div class="padder m-t m-b" >
        <div class="timeline">
            <article class="timeline-item active" style='margin-bottom:10px;'><a href='#' id='load-more-issues' class='btn btn-small'>Number of issues</a></article>

            <div class='timeline-items'>
            </div>
        </div>
      </div>
    </section>
    <!-- /.main -->
    <!-- .sidebar -->
    <aside class="sidebar sidebar-large bg-lighter padder clearfix">
      <h5>Timeline(36)</h5>
      <div class="line"></div>
      <form>
        <label>Name</label>
        <input type="text" placeholder="Event name" class="input-small form-control">        
        <label class="m-t-mini">Date</label>
        <input type="text" placeholder="Event name" class="datepicker input-small form-control">
        <label class="m-t-mini">Time</label>
        <input type="text" placeholder="eg. 3:00 pm" class="input-small form-control">
        <label class="m-t-mini">Type</label>
        <div>
          <div class="btn-group">
            <button data-toggle="dropdown" class="btn btn-small btn-white dropdown-toggle">
              <span class="dropdown-label">Choose a type</span> 
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu dropdown-select">
                <li><a href="#"><input type="radio" name="d-s-r">Travel</a></li>
                <li class=""><a href="#"><input type="radio" name="d-s-r">Phone</a></li>
                <li class=""><a href="#"><input type="radio" name="d-s-r">Meeting</a></li>
                <li class=""><a href="#"><input type="radio" name="d-s-r">Appointment</a></li>
            </ul>
          </div>
        </div>
        <div class="m-t"><button class="btn btn-small btn-info">Add an event</button></div>
      </form>
    </aside>
    <!-- /.sidebar -->
  </section>
  <!-- footer -->
  <footer id="footer">
    <div class="text-center padder clearfix">
      <p>
        <small>&copy; first 2013, Mobile first web app framework base on Bootstrap</small><br><br>
        <a href="#" class="btn btn-mini btn-circle btn-twitter"><i class="icon-twitter"></i></a>
        <a href="#" class="btn btn-mini btn-circle btn-facebook"><i class="icon-facebook"></i></a>
        <a href="#" class="btn btn-mini btn-circle btn-gplus"><i class="icon-google-plus"></i></a>
      </p>
    </div>

  </footer>
  <!-- / footer -->
	<script src="js/jquery.min.js"></script>
  <!-- Bootstrap -->
  <script src="js/bootstrap.js"></script>  
  <!-- templating engine for rendering the issue items -->
  <script src='js/jquery.tmpl.min.js'></script>
  <!-- pretty printing date -->
  <script src='js/prettydate.js'></script>

  <script id="issue_template" type="text/x-jquery-tmpl">
    <article class="timeline-item ${alt}">
      <div class="timeline-caption">
        <div class="panel arrow arrow-${arrow}">
          <span class="timeline-icon"><a href='http://changebadtogood.com/issues/${id}' target='_blank'><i class="time-icon ${rating_class} ${indicator}"></i></a></span>
          <span class="timeline-date">${pretty_date}</span>
          <h5>
            <span>${categoty_at_title}</span>
            ${title}
          </h5>            
        </div>
      </div>
    </article>
  </script>
  <script type="text/javascript">
    var last_id=0;
	var number_of_issue = ""
    function updateTimeline(){
      $.getJSON("http://changebadtogood.com/issues.json",function(issues){
        $.each(issues,function(index,issue){
          if(parseInt(issue.id) > last_id)
          {
            if(index%2==0)
              issue = $.extend(issue,{'alt':'alt','arrow':'right'})
            else
              issue = $.extend(issue,{'alt':'','arrow':'left'});
			  
            var indicator = issue.indicator.split('-')[0];
            if(indicator=='ugly')
              issue = $.extend(issue,{'indicator':'bg-danger'});
			else if(indicator=='bad')
              issue = $.extend(issue,{'indicator':'bg-warning'});
            else if(indicator=='good')
              issue = $.extend(issue,{'indicator':'bg-success'});
			  
			var category = issue.category
			var date = getDateValue(issue.updated_at)
			issue = $.extend(issue,{'pretty_date': date});
			if(category == 1){
			  issue = $.extend(issue,{'rating_class':'icon-tint'});			 
			  issue = $.extend(issue,{'categoty_at_title':'Water'});
     	    }
			else if(category == 2){
              issue = $.extend(issue,{'rating_class':'icon-road'});
			  issue = $.extend(issue,{'categoty_at_title':'Road'});
			}
			else if(category == 3){
              issue = $.extend(issue,{'rating_class':'icon-male'});
			  issue = $.extend(issue,{'categoty_at_title':'Walk-Path'});
			}
			else if(category == 4){
              issue = $.extend(issue,{'rating_class':'icon-lightbulb'});
			  issue = $.extend(issue,{'categoty_at_title':'Electricity'});
			}
			else if(category == 5){
              issue = $.extend(issue,{'rating_class':'icon-trash'});
			  issue = $.extend(issue,{'categoty_at_title':'Garbage'});
			}

            $('#issue_template').tmpl(issue).prependTo('.timeline').slideDown('slow');
          }
        });
		number_of_issue = issues.length;
        last_id = issues[issues.length-1].id;
      });
    }
	
	function getDateValue(date){
	  var d =new Date(date);
	  var x,y,z ="";
	  var month= ["January","February","March","April","May","June","July","August","September","October","November","December"]
	  x = d.getDate();
	  z = d.getFullYear();
	  y=month[d.getMonth()];
      return (x + "-"+ y + "-" + z)
	}
    $(document).ready(function(){
      updateTimeline();

      $('#load-more-issues').click(function(){
        updateTimeline();
        $(this).html('<i class="icon-spinner icon-spin"></i> Loading');
      })
      $( document ).ajaxComplete(function() {
        $( "#load-more-issues" ).html("Number of issues - "+number_of_issue);
      });
    });
  </script>


</body>
</html>